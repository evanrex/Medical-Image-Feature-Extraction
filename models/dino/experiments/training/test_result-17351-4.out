running job: 4
| distributed init (rank 0): env://
git:
  sha: cb711401860da580817918b9167ed73e3eef3dcf, status: has uncommited changes, branch: main

arch: resnet50
avgpool_patchtokens: False
batch_size_per_gpu: 128
checkpoint_key: teacher
data_path: /home-mscluster/erex/research_project/datasets/Covidx-CT
dist_url: env://
epochs: 100
evaluate: False
evaluate_on_test: True
gpu: 0
local_rank: 0
lr: 0.001
n_last_blocks: 4
num_labels: 2
num_workers: 10
output_dir: /home-mscluster/erex/research_project/models/dino/experiments/training/saving_dir4
patch_size: 16
pretrained_linear_weights: /home-mscluster/erex/research_project/models/dino/experiments/training/saving_dir4/checkpoint.pth.tar
pretrained_weights: /home-mscluster/erex/research_project/models/dino/experiments/pre-training/saving_dir4/checkpoint.pth
rank: 0
val_freq: 1
world_size: 1
Take key teacher in provided checkpoint dict
Pretrained weights found at /home-mscluster/erex/research_project/models/dino/experiments/pre-training/saving_dir4/checkpoint.pth and loaded with msg: _IncompatibleKeys(missing_keys=[], unexpected_keys=['head.mlp.0.weight', 'head.mlp.0.bias', 'head.mlp.2.weight', 'head.mlp.2.bias', 'head.mlp.4.weight', 'head.mlp.4.bias', 'head.last_layer.weight_g', 'head.last_layer.weight_v'])
Model resnet50 built.
/home-mscluster/erex/anaconda3/lib/python3.9/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
============ Evaluating Model on Test partition ============
* Acc@1 0.0 | loss 3.092695713043213
* Acc@1 10.9375 | loss 1.9137721061706543
* Acc@1 0.0 | loss 4.755380630493164
* Acc@1 12.5 | loss 2.663536787033081
* Acc@1 20.3125 | loss 3.1002790927886963
* Acc@1 25.0 | loss 2.1082639694213867
* Acc@1 34.375 | loss 1.1652888059616089
* Acc@1 32.8125 | loss 1.6303108930587769
* Acc@1 35.9375 | loss 1.5281943082809448
* Acc@1 25.78125 | loss 1.2884141206741333
* Acc@1 17.1875 | loss 1.7258285284042358
* Acc@1 44.53125 | loss 1.6933711767196655
* Acc@1 33.59375 | loss 1.4018337726593018
* Acc@1 17.1875 | loss 2.3906455039978027
* Acc@1 12.5 | loss 2.328070878982544
* Acc@1 25.0 | loss 1.4787803888320923
* Acc@1 3.125 | loss 2.1735246181488037
* Acc@1 27.34375 | loss 1.3890210390090942
* Acc@1 21.875 | loss 1.6260555982589722
* Acc@1 34.375 | loss 1.2318601608276367
* Acc@1 3.90625 | loss 2.2065157890319824
* Acc@1 29.6875 | loss 1.8098450899124146
* Acc@1 19.53125 | loss 1.8238027095794678
* Acc@1 53.125 | loss 0.9410672187805176
* Acc@1 28.90625 | loss 1.3746353387832642
* Acc@1 42.1875 | loss 1.1269447803497314
* Acc@1 19.53125 | loss 1.6007635593414307
* Acc@1 35.9375 | loss 0.9292038679122925
* Acc@1 50.0 | loss 0.8505139350891113
* Acc@1 57.03125 | loss 0.628441333770752
* Acc@1 31.25 | loss 1.868273138999939
* Acc@1 10.15625 | loss 1.6530678272247314
* Acc@1 25.78125 | loss 1.8571990728378296
* Acc@1 16.40625 | loss 2.071755886077881
* Acc@1 11.71875 | loss 1.6740425825119019
* Acc@1 14.0625 | loss 1.857409119606018
* Acc@1 15.625 | loss 1.734944224357605
* Acc@1 53.125 | loss 0.7989455461502075
* Acc@1 28.90625 | loss 1.7100846767425537
* Acc@1 51.5625 | loss 1.1748976707458496
* Acc@1 53.90625 | loss 0.631770133972168
* Acc@1 27.34375 | loss 1.4832910299301147
* Acc@1 25.78125 | loss 1.3483099937438965
* Acc@1 11.71875 | loss 2.486985683441162
* Acc@1 9.375 | loss 1.8152369260787964
* Acc@1 17.96875 | loss 1.8916655778884888
* Acc@1 12.5 | loss 1.7108582258224487
* Acc@1 11.71875 | loss 1.6880172491073608
* Acc@1 29.6875 | loss 1.313784122467041
* Acc@1 100.0 | loss 0.2486041784286499
* Acc@1 94.53125 | loss 0.2610022723674774
* Acc@1 100.0 | loss 0.19559592008590698
* Acc@1 97.65625 | loss 0.2063899040222168
* Acc@1 100.0 | loss 0.03459668904542923
* Acc@1 100.0 | loss 0.04160430654883385
* Acc@1 100.0 | loss 0.05806633085012436
* Acc@1 100.0 | loss 0.0595162995159626
* Acc@1 89.0625 | loss 0.33591726422309875
* Acc@1 78.90625 | loss 0.35893315076828003
* Acc@1 96.875 | loss 0.23304137587547302
* Acc@1 30.46875 | loss 1.235713243484497
* Acc@1 27.34375 | loss 0.954413115978241
* Acc@1 78.90625 | loss 0.45771247148513794
* Acc@1 79.6875 | loss 0.3433758318424225
* Acc@1 100.0 | loss 0.05164499580860138
* Acc@1 35.15625 | loss 1.1323966979980469
* Acc@1 86.71875 | loss 0.4839114844799042
* Acc@1 86.71875 | loss 0.3431423604488373
* Acc@1 50.0 | loss 0.705114483833313
* Acc@1 94.53125 | loss 0.30448153614997864
* Acc@1 99.21875 | loss 0.20301136374473572
* Acc@1 96.09375 | loss 0.3087383806705475
* Acc@1 99.21875 | loss 0.1411779373884201
* Acc@1 95.3125 | loss 0.21976245939731598
* Acc@1 73.4375 | loss 0.6023842692375183
* Acc@1 84.375 | loss 0.4416874051094055
* Acc@1 39.0625 | loss 0.8021203279495239
* Acc@1 29.6875 | loss 1.102236270904541
* Acc@1 37.5 | loss 1.398230791091919
* Acc@1 25.78125 | loss 1.4571022987365723
* Acc@1 82.8125 | loss 0.3881661891937256
* Acc@1 100.0 | loss 0.11142657697200775
* Acc@1 53.125 | loss 0.757979691028595
* Acc@1 89.0625 | loss 0.3494010269641876
* Acc@1 98.4375 | loss 0.1198582798242569
* Acc@1 100.0 | loss 0.13552318513393402
* Acc@1 93.75 | loss 0.2241966724395752
* Acc@1 96.09375 | loss 0.166480153799057
* Acc@1 81.25 | loss 0.3851252794265747
* Acc@1 75.0 | loss 0.5351994037628174
* Acc@1 98.4375 | loss 0.2060079425573349
* Acc@1 39.84375 | loss 0.8145930767059326
* Acc@1 100.0 | loss 0.16329438984394073
* Acc@1 99.21875 | loss 0.13802379369735718
* Acc@1 100.0 | loss 0.20924615859985352
* Acc@1 96.09375 | loss 0.2109680473804474
* Acc@1 66.40625 | loss 1.03806734085083
* Acc@1 85.9375 | loss 0.29730039834976196
* Acc@1 100.0 | loss 0.07773508131504059
* Acc@1 100.0 | loss 0.05551028251647949
* Acc@1 75.78125 | loss 0.38678446412086487
* Acc@1 6.25 | loss 1.633837103843689
* Acc@1 78.90625 | loss 0.3602399528026581
* Acc@1 96.09375 | loss 0.20494043827056885
* Acc@1 100.0 | loss 0.014022529125213623
* Acc@1 100.0 | loss 0.010653278790414333
* Acc@1 68.75 | loss 0.5962734818458557
* Acc@1 7.8125 | loss 1.7749371528625488
* Acc@1 6.25 | loss 2.2818803787231445
* Acc@1 8.59375 | loss 2.1396021842956543
* Acc@1 0.0 | loss 3.669306993484497
* Acc@1 2.34375 | loss 2.066941261291504
* Acc@1 9.375 | loss 1.7316778898239136
* Acc@1 85.15625 | loss 0.4250480830669403
* Acc@1 100.0 | loss 0.05147785320878029
* Acc@1 100.0 | loss 0.04949609190225601
* Acc@1 73.4375 | loss 0.5487397313117981
* Acc@1 75.78125 | loss 0.38023215532302856
* Acc@1 98.4375 | loss 0.11016688495874405
* Acc@1 100.0 | loss 0.06299614906311035
* Acc@1 100.0 | loss 0.04211299121379852
* Acc@1 99.21875 | loss 0.136197030544281
* Acc@1 100.0 | loss 0.017488598823547363
* Acc@1 100.0 | loss 0.02094080112874508
* Acc@1 100.0 | loss 0.08421692252159119
* Acc@1 100.0 | loss 0.06168178468942642
* Acc@1 100.0 | loss 0.08504588901996613
* Acc@1 100.0 | loss 0.02705465815961361
* Acc@1 99.21875 | loss 0.07472200691699982
* Acc@1 100.0 | loss 0.04789036884903908
* Acc@1 99.21875 | loss 0.0987681970000267
* Acc@1 100.0 | loss 0.054712407290935516
* Acc@1 100.0 | loss 0.050800222903490067
* Acc@1 100.0 | loss 0.07163916528224945
* Acc@1 100.0 | loss 0.0984305888414383
* Acc@1 93.75 | loss 0.14695559442043304
* Acc@1 92.96875 | loss 0.22095921635627747
* Acc@1 100.0 | loss 0.12906573712825775
* Acc@1 100.0 | loss 0.1281047910451889
* Acc@1 92.96875 | loss 0.2193235605955124
* Acc@1 75.78125 | loss 0.4445219933986664
* Acc@1 100.0 | loss 0.10445277392864227
* Acc@1 100.0 | loss 0.06153915449976921
* Acc@1 98.4375 | loss 0.0779474601149559
* Acc@1 99.21875 | loss 0.07823450118303299
* Acc@1 98.4375 | loss 0.08929815888404846
* Acc@1 100.0 | loss 0.024670306593179703
* Acc@1 100.0 | loss 0.027544302865862846
* Acc@1 99.21875 | loss 0.10067112743854523
* Acc@1 100.0 | loss 0.09343016892671585
* Acc@1 99.21875 | loss 0.06281384825706482
* Acc@1 82.03125 | loss 0.3980042338371277
* Acc@1 100.0 | loss 0.05767824500799179
* Acc@1 100.0 | loss 0.07392138242721558
* Acc@1 98.4375 | loss 0.1510707437992096
* Acc@1 98.4375 | loss 0.13581976294517517
* Acc@1 91.40625 | loss 0.2765348255634308
* Acc@1 90.625 | loss 0.2715035676956177
* Acc@1 100.0 | loss 0.05242324620485306
* Acc@1 100.0 | loss 0.23222126066684723
* Acc@1 100.0 | loss 0.0366298072040081
* Acc@1 100.0 | loss 0.049699291586875916
* Acc@1 100.0 | loss 0.08297687023878098
* Acc@1 99.21875 | loss 0.10573069751262665
* Acc@1 100.0 | loss 0.09477230906486511
* Acc@1 98.4375 | loss 0.050722476094961166
* Acc@1 100.0 | loss 0.070525623857975
* Acc@1 99.21875 | loss 0.04010101407766342
* Acc@1 100.0 | loss 0.002221777569502592
* Acc@1 100.0 | loss 0.010602768510580063
* Acc@1 100.0 | loss 0.0033795111812651157
* Acc@1 100.0 | loss 0.012807106599211693
* Acc@1 100.0 | loss 0.0021982663311064243
* Acc@1 100.0 | loss 0.012020195834338665
* Acc@1 100.0 | loss 0.0036859004758298397
* Acc@1 100.0 | loss 0.005765119567513466
* Acc@1 100.0 | loss 0.002302671317011118
* Acc@1 100.0 | loss 0.005557594820857048
* Acc@1 100.0 | loss 0.003145929193124175
* Acc@1 100.0 | loss 0.0028388695791363716
* Acc@1 100.0 | loss 0.0034009860828518867
* Acc@1 100.0 | loss 0.00724078668281436
* Acc@1 100.0 | loss 0.002167138271033764
* Acc@1 100.0 | loss 0.0018642897484824061
* Acc@1 100.0 | loss 0.0020789336413145065
* Acc@1 100.0 | loss 0.004464598838239908
* Acc@1 100.0 | loss 0.02153669483959675
* Acc@1 63.28125 | loss 0.659974992275238
* Acc@1 37.5 | loss 1.134416103363037
* Acc@1 58.59375 | loss 0.7248215675354004
* Acc@1 60.9375 | loss 0.7485735416412354
* Acc@1 74.21875 | loss 0.5148184299468994
* Acc@1 61.71875 | loss 0.8106341361999512
* Acc@1 53.125 | loss 0.8483551740646362
* Acc@1 50.78125 | loss 0.8174682855606079
* Acc@1 67.96875 | loss 0.7096563577651978
* Acc@1 64.0625 | loss 0.6498249769210815
* Acc@1 46.09375 | loss 0.9165599346160889
* Acc@1 43.75 | loss 1.0436762571334839
* Acc@1 37.5 | loss 1.0798710584640503
* Acc@1 40.625 | loss 1.1141018867492676
* Acc@1 57.03125 | loss 0.82860267162323
* Acc@1 71.09375 | loss 0.5722870826721191
* Acc@1 71.09375 | loss 0.46356096863746643
* Acc@1 92.1875 | loss 0.23106646537780762
* Acc@1 71.875 | loss 0.4785063564777374
* Acc@1 100.0 | loss 0.04668335244059563
* Acc@1 97.65625 | loss 0.12027252465486526
* Acc@1 100.0 | loss 0.10194209963083267
* Acc@1 100.0 | loss 0.06575239449739456
* Acc@1 100.0 | loss 0.036506734788417816
* Acc@1 99.21875 | loss 0.09705331176519394
* Acc@1 92.96875 | loss 0.11414238810539246
* Acc@1 94.53125 | loss 0.10826092958450317
* Acc@1 98.4375 | loss 0.15185391902923584
* Acc@1 100.0 | loss 0.13252462446689606
* Acc@1 100.0 | loss 0.07191547006368637
* Acc@1 100.0 | loss 0.022093724459409714
* Acc@1 100.0 | loss 0.0893365740776062
* Acc@1 96.875 | loss 0.1328859180212021
* Acc@1 88.28125 | loss 0.22643819451332092
* Acc@1 100.0 | loss 0.06717991083860397
* Acc@1 10.9375 | loss 1.9269384145736694
* Acc@1 82.03125 | loss 0.4130103588104248
* Acc@1 100.0 | loss 0.06901098042726517
* Acc@1 100.0 | loss 0.07481229305267334
* Acc@1 92.96875 | loss 0.24355359375476837
* Acc@1 100.0 | loss 0.11621631681919098
* Acc@1 72.65625 | loss 0.48220330476760864
* Acc@1 75.78125 | loss 0.5825542211532593
* Acc@1 94.53125 | loss 0.19616691768169403
* Acc@1 100.0 | loss 0.04430513083934784
* Acc@1 84.375 | loss 0.37852612137794495
* Acc@1 100.0 | loss 0.11967919766902924
* Acc@1 96.875 | loss 0.12917762994766235
* Acc@1 100.0 | loss 0.041314497590065
* Acc@1 91.40625 | loss 0.18699957430362701
* Acc@1 100.0 | loss 0.07461152970790863
* Acc@1 100.0 | loss 0.023001275956630707
* Acc@1 100.0 | loss 0.07639370858669281
* Acc@1 52.34375 | loss 0.8334700465202332
* Acc@1 40.625 | loss 0.9886211156845093
* Acc@1 99.21875 | loss 0.10002791881561279
* Acc@1 99.21875 | loss 0.05817988142371178
* Acc@1 97.65625 | loss 0.13258673250675201
* Acc@1 98.4375 | loss 0.1466173380613327
* Acc@1 100.0 | loss 0.04680037498474121
* Acc@1 96.09375 | loss 0.12570644915103912
* Acc@1 98.4375 | loss 0.10112697631120682
* Acc@1 99.21875 | loss 0.03594217821955681
* Acc@1 100.0 | loss 0.04180462658405304
* Acc@1 98.4375 | loss 0.12629686295986176
* Acc@1 99.21875 | loss 0.12026792764663696
* Acc@1 96.875 | loss 0.1253867745399475
* Acc@1 94.53125 | loss 0.23237267136573792
* Acc@1 100.0 | loss 0.011412566527724266
* Acc@1 95.3125 | loss 0.15587851405143738
* Acc@1 98.4375 | loss 0.13127200305461884
* Acc@1 99.21875 | loss 0.052517008036375046
* Acc@1 100.0 | loss 0.07484755665063858
* Acc@1 83.59375 | loss 0.281185507774353
* Acc@1 100.0 | loss 0.02579318732023239
* Acc@1 98.4375 | loss 0.06670807301998138
* Acc@1 98.29060363769531 | loss 0.1235547810792923
========== Done Evaluating Model on Test partition ==========

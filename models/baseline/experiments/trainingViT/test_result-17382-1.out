running job: 1
| distributed init (rank 0): env://
fatal: not a git repository (or any parent up to mount point /)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
git:
  sha: N/A, status: clean, branch: N/A

arch: vit_small
avgpool_patchtokens: False
batch_size_per_gpu: 128
checkpoint_key: teacher
data_path: /home-mscluster/erex/research_project/datasets/Covidx-CT
dist_url: env://
epochs: 100
evaluate: False
evaluate_on_test: True
gpu: 0
local_rank: 0
lr: 0.001
n_last_blocks: 4
num_labels: 2
num_workers: 10
output_dir: /home-mscluster/erex/research_project/models/baseline/experiments/trainingViT/saving_dir1
patch_size: 16
pretrained_linear_weights: /home-mscluster/erex/research_project/models/baseline/experiments/trainingViT/saving_dir1/checkpoint.pth.tar
pretrained_weights: /home-mscluster/erex/research_project/models/baseline/experiments/pre-trainingViT/saving_dir1/checkpoint.pth
rank: 0
val_freq: 1
world_size: 1
Take key teacher in provided checkpoint dict
Pretrained weights found at /home-mscluster/erex/research_project/models/baseline/experiments/pre-trainingViT/saving_dir1/checkpoint.pth and loaded with msg: _IncompatibleKeys(missing_keys=[], unexpected_keys=['head.mlp.0.weight', 'head.mlp.0.bias', 'head.mlp.2.weight', 'head.mlp.2.bias', 'head.mlp.4.weight', 'head.mlp.4.bias', 'head.last_layer.weight_g', 'head.last_layer.weight_v'])
Model vit_small built.
/home-mscluster/erex/anaconda3/lib/python3.9/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
============ Evaluating Model on Test partition ============
* Acc@1 25.0 | loss 1.569061040878296
* Acc@1 67.1875 | loss 0.7653194665908813
* Acc@1 20.3125 | loss 2.1007187366485596
* Acc@1 48.4375 | loss 1.4967325925827026
* Acc@1 42.1875 | loss 1.3820692300796509
* Acc@1 80.46875 | loss 0.42623576521873474
* Acc@1 97.65625 | loss 0.15082140266895294
* Acc@1 98.4375 | loss 0.1012706309556961
* Acc@1 91.40625 | loss 0.22415542602539062
* Acc@1 90.625 | loss 0.21974687278270721
* Acc@1 84.375 | loss 0.3399900496006012
* Acc@1 73.4375 | loss 0.680161714553833
* Acc@1 78.90625 | loss 0.38736414909362793
* Acc@1 92.96875 | loss 0.23036593198776245
* Acc@1 97.65625 | loss 0.2101057916879654
* Acc@1 94.53125 | loss 0.18145322799682617
* Acc@1 94.53125 | loss 0.17107194662094116
* Acc@1 98.4375 | loss 0.09057802706956863
* Acc@1 98.4375 | loss 0.1437321901321411
* Acc@1 99.21875 | loss 0.06413721293210983
* Acc@1 98.4375 | loss 0.09720088541507721
* Acc@1 97.65625 | loss 0.10224514454603195
* Acc@1 96.875 | loss 0.17623835802078247
* Acc@1 91.40625 | loss 0.22610542178153992
* Acc@1 70.3125 | loss 0.5453166365623474
* Acc@1 100.0 | loss 0.032868970185518265
* Acc@1 100.0 | loss 0.035394784063100815
* Acc@1 99.21875 | loss 0.06316511332988739
* Acc@1 100.0 | loss 0.04402937367558479
* Acc@1 91.40625 | loss 0.2688981890678406
* Acc@1 57.8125 | loss 0.8032559752464294
* Acc@1 62.5 | loss 0.6484546065330505
* Acc@1 88.28125 | loss 0.26456418633461
* Acc@1 75.78125 | loss 0.4661194682121277
* Acc@1 100.0 | loss 0.0713457390666008
* Acc@1 90.625 | loss 0.28109267354011536
* Acc@1 99.21875 | loss 0.12138689309358597
* Acc@1 99.21875 | loss 0.09545890986919403
* Acc@1 92.96875 | loss 0.16647900640964508
* Acc@1 89.84375 | loss 0.23596732318401337
* Acc@1 92.1875 | loss 0.19993799924850464
* Acc@1 99.21875 | loss 0.13003571331501007
* Acc@1 97.65625 | loss 0.11296510696411133
* Acc@1 84.375 | loss 0.37907731533050537
* Acc@1 85.15625 | loss 0.3456883728504181
* Acc@1 82.03125 | loss 0.3417198657989502
* Acc@1 85.9375 | loss 0.31585684418678284
* Acc@1 89.84375 | loss 0.2502872347831726
* Acc@1 87.5 | loss 0.26485124230384827
* Acc@1 100.0 | loss 0.0005750292330048978
* Acc@1 100.0 | loss 0.00019878672901540995
* Acc@1 100.0 | loss 9.611216228222474e-05
* Acc@1 100.0 | loss 0.0010385330533608794
* Acc@1 100.0 | loss 2.5557350454619154e-05
* Acc@1 100.0 | loss 4.2038220271933824e-05
* Acc@1 100.0 | loss 0.0006458290736190975
* Acc@1 100.0 | loss 0.004793060477823019
* Acc@1 100.0 | loss 0.0032081862445920706
* Acc@1 100.0 | loss 0.0021577647421509027
* Acc@1 100.0 | loss 0.00028483293135650456
* Acc@1 100.0 | loss 0.007020941469818354
* Acc@1 100.0 | loss 0.002835936611518264
* Acc@1 100.0 | loss 0.020943522453308105
* Acc@1 100.0 | loss 0.038889653980731964
* Acc@1 100.0 | loss 0.01998572237789631
* Acc@1 100.0 | loss 0.020244840532541275
* Acc@1 100.0 | loss 0.0031673761550337076
* Acc@1 100.0 | loss 6.347046291921288e-05
* Acc@1 100.0 | loss 0.0010345045011490583
* Acc@1 100.0 | loss 0.01607685163617134
* Acc@1 100.0 | loss 0.00609959801658988
* Acc@1 100.0 | loss 9.794912330107763e-05
* Acc@1 100.0 | loss 0.0052713691256940365
* Acc@1 100.0 | loss 0.0005972245126031339
* Acc@1 100.0 | loss 9.598895849194378e-05
* Acc@1 100.0 | loss 0.011665656231343746
* Acc@1 100.0 | loss 0.02525569498538971
* Acc@1 97.65625 | loss 0.08158792555332184
* Acc@1 98.4375 | loss 0.0886707529425621
* Acc@1 98.4375 | loss 0.05150790885090828
* Acc@1 100.0 | loss 0.009686297737061977
* Acc@1 100.0 | loss 0.0004531306913122535
* Acc@1 100.0 | loss 0.005031711421906948
* Acc@1 100.0 | loss 0.0032966313883662224
* Acc@1 94.53125 | loss 0.09845446795225143
* Acc@1 100.0 | loss 0.023794546723365784
* Acc@1 99.21875 | loss 0.03221769258379936
* Acc@1 95.3125 | loss 0.07536783814430237
* Acc@1 96.09375 | loss 0.06244577839970589
* Acc@1 97.65625 | loss 0.09869850426912308
* Acc@1 99.21875 | loss 0.027804728597402573
* Acc@1 76.5625 | loss 0.4618093967437744
* Acc@1 100.0 | loss 0.0007259057019837201
* Acc@1 100.0 | loss 0.0007524757529608905
* Acc@1 100.0 | loss 0.00034439004957675934
* Acc@1 100.0 | loss 0.002363884588703513
* Acc@1 100.0 | loss 0.01364124659448862
* Acc@1 100.0 | loss 0.013207790441811085
* Acc@1 100.0 | loss 0.0014263995690271258
* Acc@1 100.0 | loss 0.001368164666928351
* Acc@1 100.0 | loss 0.0034953905269503593
* Acc@1 100.0 | loss 0.049571167677640915
* Acc@1 100.0 | loss 0.011558123864233494
* Acc@1 96.875 | loss 0.09623424708843231
* Acc@1 100.0 | loss 0.00012289259757380933
* Acc@1 100.0 | loss 0.0030327830463647842
* Acc@1 89.84375 | loss 0.17075537145137787
* Acc@1 92.96875 | loss 0.1459595412015915
* Acc@1 80.46875 | loss 0.3684825599193573
* Acc@1 85.9375 | loss 0.29415908455848694
* Acc@1 96.09375 | loss 0.16277764737606049
* Acc@1 96.875 | loss 0.07709836214780807
* Acc@1 99.21875 | loss 0.050863176584243774
* Acc@1 100.0 | loss 0.008388780057430267
* Acc@1 100.0 | loss 0.00047791824908927083
* Acc@1 100.0 | loss 0.00016055352170951664
* Acc@1 100.0 | loss 0.0012544968631118536
* Acc@1 100.0 | loss 0.002232798608019948
* Acc@1 100.0 | loss 0.0031337931286543608
* Acc@1 100.0 | loss 3.652107989182696e-05
* Acc@1 100.0 | loss 3.242716775275767e-05
* Acc@1 100.0 | loss 7.591882604174316e-05
* Acc@1 100.0 | loss 4.44573670392856e-05
* Acc@1 100.0 | loss 0.0001616769441170618
* Acc@1 100.0 | loss 0.00030615919968113303
* Acc@1 100.0 | loss 0.0008543278090655804
* Acc@1 100.0 | loss 0.0011516762897372246
* Acc@1 100.0 | loss 7.240792911034077e-05
* Acc@1 100.0 | loss 0.0008804657263681293
* Acc@1 100.0 | loss 0.0004584075650200248
* Acc@1 99.21875 | loss 0.035168468952178955
* Acc@1 100.0 | loss 0.003548072651028633
* Acc@1 100.0 | loss 0.0005014630733057857
* Acc@1 100.0 | loss 0.0006926908390596509
* Acc@1 100.0 | loss 0.0006819700356572866
* Acc@1 100.0 | loss 0.00047038591583259404
* Acc@1 100.0 | loss 0.0026026074774563313
* Acc@1 100.0 | loss 0.0012770165922120214
* Acc@1 100.0 | loss 0.0006533851264975965
* Acc@1 100.0 | loss 0.0001932732411660254
* Acc@1 100.0 | loss 0.00020408454292919487
* Acc@1 100.0 | loss 0.0003198690537828952
* Acc@1 100.0 | loss 0.0004660973499994725
* Acc@1 100.0 | loss 0.0007543035317212343
* Acc@1 100.0 | loss 0.0009366743033751845
* Acc@1 100.0 | loss 0.0003445422335062176
* Acc@1 100.0 | loss 0.0001864568912424147
* Acc@1 100.0 | loss 0.00034767951001413167
* Acc@1 100.0 | loss 0.0008567658951506019
* Acc@1 100.0 | loss 0.00040080133476294577
* Acc@1 100.0 | loss 0.0015301043167710304
* Acc@1 100.0 | loss 0.0004989192821085453
* Acc@1 100.0 | loss 0.000227215641643852
* Acc@1 100.0 | loss 5.5865628382889554e-05
* Acc@1 100.0 | loss 0.0008677757577970624
* Acc@1 100.0 | loss 0.0004174932837486267
* Acc@1 100.0 | loss 0.000818907399661839
* Acc@1 100.0 | loss 0.013189807534217834
* Acc@1 100.0 | loss 0.003268833737820387
* Acc@1 100.0 | loss 0.003114428138360381
* Acc@1 100.0 | loss 0.0004838047025259584
* Acc@1 100.0 | loss 0.001007022219710052
* Acc@1 100.0 | loss 0.00031925199436955154
* Acc@1 100.0 | loss 0.0004396506992634386
* Acc@1 100.0 | loss 0.007016411516815424
* Acc@1 100.0 | loss 0.0005365219549275935
* Acc@1 100.0 | loss 0.00011380835348973051
* Acc@1 100.0 | loss 6.891363591421396e-05
* Acc@1 100.0 | loss 2.605151166790165e-05
* Acc@1 100.0 | loss 1.0395208846603055e-05
* Acc@1 100.0 | loss 6.52243907097727e-05
* Acc@1 100.0 | loss 0.00017329897673334926
* Acc@1 100.0 | loss 4.907022230327129e-06
* Acc@1 100.0 | loss 3.5278237646707566e-06
* Acc@1 100.0 | loss 6.426061736419797e-05
* Acc@1 100.0 | loss 2.997903493451304e-06
* Acc@1 100.0 | loss 5.706848241970874e-06
* Acc@1 100.0 | loss 3.4197958029835718e-06
* Acc@1 100.0 | loss 1.2154295291111339e-05
* Acc@1 100.0 | loss 1.5179820366029162e-05
* Acc@1 100.0 | loss 1.7449838196625933e-05
* Acc@1 100.0 | loss 5.18569941050373e-05
* Acc@1 100.0 | loss 2.2482887288788334e-05
* Acc@1 100.0 | loss 9.630941349314526e-06
* Acc@1 100.0 | loss 3.556871524779126e-05
* Acc@1 100.0 | loss 5.980026799079496e-06
* Acc@1 100.0 | loss 0.0008079700637608767
* Acc@1 100.0 | loss 0.01854545809328556
* Acc@1 100.0 | loss 0.011707045137882233
* Acc@1 99.21875 | loss 0.03795560076832771
* Acc@1 89.84375 | loss 0.2604105770587921
* Acc@1 100.0 | loss 0.014235038310289383
* Acc@1 96.875 | loss 0.09911825507879257
* Acc@1 99.21875 | loss 0.039864398539066315
* Acc@1 98.4375 | loss 0.0654677152633667
* Acc@1 100.0 | loss 0.024429097771644592
* Acc@1 100.0 | loss 0.0368008017539978
* Acc@1 100.0 | loss 0.044097185134887695
* Acc@1 84.375 | loss 0.4016130268573761
* Acc@1 100.0 | loss 0.03293607011437416
* Acc@1 100.0 | loss 0.028680777177214622
* Acc@1 94.53125 | loss 0.1754797101020813
* Acc@1 58.59375 | loss 1.0902339220046997
* Acc@1 53.90625 | loss 1.0730443000793457
* Acc@1 55.46875 | loss 0.9169806241989136
* Acc@1 55.46875 | loss 1.258013367652893
* Acc@1 92.96875 | loss 0.2359790802001953
* Acc@1 61.71875 | loss 0.7228545546531677
* Acc@1 79.6875 | loss 0.4373217821121216
* Acc@1 81.25 | loss 0.38384416699409485
* Acc@1 84.375 | loss 0.485081285238266
* Acc@1 74.21875 | loss 0.708303689956665
* Acc@1 74.21875 | loss 0.6655526161193848
* Acc@1 84.375 | loss 0.5447051525115967
* Acc@1 67.96875 | loss 0.6249089241027832
* Acc@1 21.09375 | loss 1.9754979610443115
* Acc@1 85.15625 | loss 0.37912091612815857
* Acc@1 96.875 | loss 0.1543269157409668
* Acc@1 58.59375 | loss 0.8720818758010864
* Acc@1 89.0625 | loss 0.28693297505378723
* Acc@1 68.75 | loss 0.7358697652816772
* Acc@1 99.21875 | loss 0.033377476036548615
* Acc@1 11.71875 | loss 3.3631808757781982
* Acc@1 91.40625 | loss 0.16496293246746063
* Acc@1 100.0 | loss 0.013832194730639458
* Acc@1 98.4375 | loss 0.06555825471878052
* Acc@1 80.46875 | loss 0.3987852931022644
* Acc@1 85.15625 | loss 0.34068429470062256
* Acc@1 78.125 | loss 0.5794650912284851
* Acc@1 60.9375 | loss 1.2747039794921875
* Acc@1 95.3125 | loss 0.1578109711408615
* Acc@1 99.21875 | loss 0.058446045964956284
* Acc@1 93.75 | loss 0.1719854176044464
* Acc@1 98.4375 | loss 0.056504469364881516
* Acc@1 100.0 | loss 0.003950995858758688
* Acc@1 100.0 | loss 0.0007787618669681251
* Acc@1 85.9375 | loss 0.3043365180492401
* Acc@1 100.0 | loss 0.020770622417330742
* Acc@1 100.0 | loss 0.0010149023728445172
* Acc@1 98.4375 | loss 0.04949508607387543
* Acc@1 68.75 | loss 1.046474814414978
* Acc@1 47.65625 | loss 1.5421606302261353
* Acc@1 97.65625 | loss 0.07682372629642487
* Acc@1 100.0 | loss 0.0040328484028577805
* Acc@1 100.0 | loss 0.031379275023937225
* Acc@1 99.21875 | loss 0.02251346968114376
* Acc@1 100.0 | loss 0.003709350945428014
* Acc@1 87.5 | loss 0.27403777837753296
* Acc@1 97.65625 | loss 0.09542442113161087
* Acc@1 99.21875 | loss 0.03348705917596817
* Acc@1 100.0 | loss 0.021380841732025146
* Acc@1 92.1875 | loss 0.17348411679267883
* Acc@1 96.875 | loss 0.0837441012263298
* Acc@1 66.40625 | loss 0.8270842432975769
* Acc@1 75.0 | loss 0.7389749884605408
* Acc@1 100.0 | loss 0.018680045381188393
* Acc@1 81.25 | loss 0.41615375876426697
* Acc@1 84.375 | loss 0.5397221446037292
* Acc@1 94.53125 | loss 0.17541196942329407
* Acc@1 72.65625 | loss 0.5540158748626709
* Acc@1 69.53125 | loss 1.13639497756958
* Acc@1 98.4375 | loss 0.06197093799710274
* Acc@1 86.71875 | loss 0.4051777124404907
* Acc@1 89.74359130859375 | loss 0.2126580774784088
========== Done Evaluating Model on Test partition ==========

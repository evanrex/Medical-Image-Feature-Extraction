running job: 2
| distributed init (rank 0): env://
fatal: not a git repository (or any parent up to mount point /)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
git:
  sha: N/A, status: clean, branch: N/A

arch: vit_small
avgpool_patchtokens: False
batch_size_per_gpu: 128
checkpoint_key: teacher
data_path: /home-mscluster/erex/research_project/datasets/Covidx-CT
dist_url: env://
epochs: 100
evaluate: False
evaluate_on_test: True
gpu: 0
local_rank: 0
lr: 0.001
n_last_blocks: 4
num_labels: 2
num_workers: 10
output_dir: /home-mscluster/erex/research_project/models/baseline/experiments/trainingViT/saving_dir2
patch_size: 16
pretrained_linear_weights: /home-mscluster/erex/research_project/models/baseline/experiments/trainingViT/saving_dir2/checkpoint.pth.tar
pretrained_weights: /home-mscluster/erex/research_project/models/baseline/experiments/pre-trainingViT/saving_dir1/checkpoint.pth
rank: 0
val_freq: 1
world_size: 1
Take key teacher in provided checkpoint dict
Pretrained weights found at /home-mscluster/erex/research_project/models/baseline/experiments/pre-trainingViT/saving_dir1/checkpoint.pth and loaded with msg: _IncompatibleKeys(missing_keys=[], unexpected_keys=['head.mlp.0.weight', 'head.mlp.0.bias', 'head.mlp.2.weight', 'head.mlp.2.bias', 'head.mlp.4.weight', 'head.mlp.4.bias', 'head.last_layer.weight_g', 'head.last_layer.weight_v'])
Model vit_small built.
/home-mscluster/erex/anaconda3/lib/python3.9/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
============ Evaluating Model on Test partition ============
* Acc@1 7.8125 | loss 3.924126625061035
* Acc@1 7.03125 | loss 3.3786072731018066
* Acc@1 0.78125 | loss 4.8564653396606445
* Acc@1 20.3125 | loss 3.96834659576416
* Acc@1 22.65625 | loss 3.81685209274292
* Acc@1 32.03125 | loss 1.9620307683944702
* Acc@1 17.1875 | loss 1.7041969299316406
* Acc@1 34.375 | loss 1.2341078519821167
* Acc@1 28.125 | loss 1.7195255756378174
* Acc@1 32.8125 | loss 1.540046215057373
* Acc@1 20.3125 | loss 1.827148675918579
* Acc@1 33.59375 | loss 2.3827381134033203
* Acc@1 28.90625 | loss 2.0972697734832764
* Acc@1 28.125 | loss 1.8847719430923462
* Acc@1 25.78125 | loss 1.8119226694107056
* Acc@1 40.625 | loss 1.3889950513839722
* Acc@1 25.78125 | loss 1.675798773765564
* Acc@1 46.875 | loss 1.004072666168213
* Acc@1 26.5625 | loss 1.4731541872024536
* Acc@1 54.6875 | loss 1.0282624959945679
* Acc@1 38.28125 | loss 1.113214373588562
* Acc@1 47.65625 | loss 0.9536430835723877
* Acc@1 21.875 | loss 1.451972246170044
* Acc@1 31.25 | loss 1.544282078742981
* Acc@1 17.1875 | loss 2.3664638996124268
* Acc@1 75.78125 | loss 0.5444234609603882
* Acc@1 78.90625 | loss 0.45481395721435547
* Acc@1 42.96875 | loss 0.9856703877449036
* Acc@1 50.0 | loss 0.787227988243103
* Acc@1 29.6875 | loss 1.6411139965057373
* Acc@1 8.59375 | loss 2.9275805950164795
* Acc@1 16.40625 | loss 2.6803202629089355
* Acc@1 21.875 | loss 1.7739226818084717
* Acc@1 28.90625 | loss 2.333163261413574
* Acc@1 52.34375 | loss 0.8917561173439026
* Acc@1 12.5 | loss 2.115933418273926
* Acc@1 16.40625 | loss 1.611688494682312
* Acc@1 39.0625 | loss 1.1924984455108643
* Acc@1 37.5 | loss 1.3167885541915894
* Acc@1 35.9375 | loss 1.5547536611557007
* Acc@1 39.84375 | loss 1.4935729503631592
* Acc@1 19.53125 | loss 1.5282413959503174
* Acc@1 47.65625 | loss 1.140777587890625
* Acc@1 10.15625 | loss 2.390434980392456
* Acc@1 18.75 | loss 1.8647440671920776
* Acc@1 24.21875 | loss 2.2935030460357666
* Acc@1 26.5625 | loss 1.8910598754882812
* Acc@1 12.5 | loss 1.8724889755249023
* Acc@1 28.125 | loss 1.7139270305633545
* Acc@1 99.21875 | loss 0.010176449082791805
* Acc@1 100.0 | loss 0.006943256128579378
* Acc@1 100.0 | loss 0.003782647429034114
* Acc@1 98.4375 | loss 0.03528621420264244
* Acc@1 100.0 | loss 0.00030565683846361935
* Acc@1 100.0 | loss 0.00034672277979552746
* Acc@1 100.0 | loss 0.01459681149572134
* Acc@1 96.09375 | loss 0.07873829454183578
* Acc@1 96.875 | loss 0.10273879766464233
* Acc@1 100.0 | loss 0.021186940371990204
* Acc@1 100.0 | loss 0.00708052609115839
* Acc@1 96.875 | loss 0.10043102502822876
* Acc@1 98.4375 | loss 0.05281529575586319
* Acc@1 86.71875 | loss 0.2950361669063568
* Acc@1 81.25 | loss 0.43239232897758484
* Acc@1 95.3125 | loss 0.09421727806329727
* Acc@1 77.34375 | loss 0.44576865434646606
* Acc@1 99.21875 | loss 0.040354449301958084
* Acc@1 100.0 | loss 0.0021364763379096985
* Acc@1 99.21875 | loss 0.05579666793346405
* Acc@1 92.96875 | loss 0.18257097899913788
* Acc@1 98.4375 | loss 0.05153534561395645
* Acc@1 100.0 | loss 0.001048425561748445
* Acc@1 98.4375 | loss 0.043027669191360474
* Acc@1 100.0 | loss 0.008394399657845497
* Acc@1 100.0 | loss 0.0014197488781064749
* Acc@1 94.53125 | loss 0.12808579206466675
* Acc@1 80.46875 | loss 0.40197014808654785
* Acc@1 78.90625 | loss 0.5285652279853821
* Acc@1 42.96875 | loss 1.1323862075805664
* Acc@1 68.75 | loss 0.6813750267028809
* Acc@1 92.96875 | loss 0.13409489393234253
* Acc@1 100.0 | loss 0.0028320502024143934
* Acc@1 99.21875 | loss 0.02957037277519703
* Acc@1 100.0 | loss 0.02298896014690399
* Acc@1 88.28125 | loss 0.31682032346725464
* Acc@1 89.84375 | loss 0.17529171705245972
* Acc@1 93.75 | loss 0.15986838936805725
* Acc@1 93.75 | loss 0.21050646901130676
* Acc@1 89.84375 | loss 0.29597118496894836
* Acc@1 79.6875 | loss 0.49695274233818054
* Acc@1 89.0625 | loss 0.22594477236270905
* Acc@1 39.84375 | loss 1.5342493057250977
* Acc@1 100.0 | loss 0.009581849910318851
* Acc@1 100.0 | loss 0.011303233914077282
* Acc@1 100.0 | loss 0.0031751433853060007
* Acc@1 99.21875 | loss 0.03521193563938141
* Acc@1 89.0625 | loss 0.25478121638298035
* Acc@1 92.1875 | loss 0.1842111200094223
* Acc@1 100.0 | loss 0.006574362516403198
* Acc@1 100.0 | loss 0.004519728943705559
* Acc@1 100.0 | loss 0.02980191260576248
* Acc@1 78.90625 | loss 0.4154246151447296
* Acc@1 96.09375 | loss 0.11216557770967484
* Acc@1 72.65625 | loss 0.5155639052391052
* Acc@1 100.0 | loss 0.0009453854290768504
* Acc@1 99.21875 | loss 0.02278336137533188
* Acc@1 73.4375 | loss 0.8681094646453857
* Acc@1 68.75 | loss 0.8211579918861389
* Acc@1 33.59375 | loss 1.5981361865997314
* Acc@1 48.4375 | loss 1.9016008377075195
* Acc@1 28.125 | loss 1.5134215354919434
* Acc@1 60.15625 | loss 0.8213812708854675
* Acc@1 71.875 | loss 0.58204585313797
* Acc@1 93.75 | loss 0.09333789348602295
* Acc@1 100.0 | loss 0.0101586002856493
* Acc@1 100.0 | loss 0.006206228863447905
* Acc@1 100.0 | loss 0.03118235617876053
* Acc@1 100.0 | loss 0.03674236312508583
* Acc@1 98.4375 | loss 0.03091231919825077
* Acc@1 100.0 | loss 0.0006063503678888083
* Acc@1 100.0 | loss 0.0005851556197740138
* Acc@1 100.0 | loss 0.002616147743538022
* Acc@1 100.0 | loss 0.0004821675829589367
* Acc@1 100.0 | loss 0.0027054022066295147
* Acc@1 100.0 | loss 0.0045481533743441105
* Acc@1 100.0 | loss 0.023043477907776833
* Acc@1 99.21875 | loss 0.020151374861598015
* Acc@1 100.0 | loss 0.0012309885350987315
* Acc@1 100.0 | loss 0.00759833725169301
* Acc@1 100.0 | loss 0.00789999682456255
* Acc@1 89.84375 | loss 0.2494419515132904
* Acc@1 99.21875 | loss 0.033935122191905975
* Acc@1 100.0 | loss 0.008542500436306
* Acc@1 100.0 | loss 0.003910600673407316
* Acc@1 100.0 | loss 0.007725812960416079
* Acc@1 100.0 | loss 0.013033751398324966
* Acc@1 98.4375 | loss 0.05130290612578392
* Acc@1 99.21875 | loss 0.025035612285137177
* Acc@1 100.0 | loss 0.002315324964001775
* Acc@1 100.0 | loss 0.005247050430625677
* Acc@1 100.0 | loss 0.005966533441096544
* Acc@1 100.0 | loss 0.001874355599284172
* Acc@1 100.0 | loss 0.003914366010576487
* Acc@1 100.0 | loss 0.009438206441700459
* Acc@1 100.0 | loss 0.012794146314263344
* Acc@1 100.0 | loss 0.0034814816899597645
* Acc@1 100.0 | loss 0.0026478730142116547
* Acc@1 100.0 | loss 0.002371215494349599
* Acc@1 100.0 | loss 0.010668198578059673
* Acc@1 100.0 | loss 0.0038925602566450834
* Acc@1 100.0 | loss 0.016988122835755348
* Acc@1 100.0 | loss 0.007974394597113132
* Acc@1 100.0 | loss 0.0069667682982981205
* Acc@1 100.0 | loss 0.0022191032767295837
* Acc@1 100.0 | loss 0.019072692841291428
* Acc@1 99.21875 | loss 0.023633452132344246
* Acc@1 100.0 | loss 0.020762337371706963
* Acc@1 87.5 | loss 0.29371950030326843
* Acc@1 91.40625 | loss 0.16398903727531433
* Acc@1 96.875 | loss 0.1076098084449768
* Acc@1 100.0 | loss 0.005608797539025545
* Acc@1 100.0 | loss 0.014040538109838963
* Acc@1 100.0 | loss 0.004440576769411564
* Acc@1 100.0 | loss 0.008889036253094673
* Acc@1 96.09375 | loss 0.10148908942937851
* Acc@1 100.0 | loss 0.006001163739711046
* Acc@1 100.0 | loss 0.0022640221286565065
* Acc@1 100.0 | loss 0.003317710943520069
* Acc@1 100.0 | loss 0.00021218248002696782
* Acc@1 100.0 | loss 0.00015715559129603207
* Acc@1 100.0 | loss 0.0013986086705699563
* Acc@1 100.0 | loss 0.0029924085829406977
* Acc@1 100.0 | loss 3.069929516641423e-05
* Acc@1 100.0 | loss 6.342853157548234e-05
* Acc@1 100.0 | loss 0.0007735085673630238
* Acc@1 100.0 | loss 5.8684705436462536e-05
* Acc@1 100.0 | loss 9.706131822895259e-05
* Acc@1 100.0 | loss 4.517335401033051e-05
* Acc@1 100.0 | loss 0.0004491687286645174
* Acc@1 100.0 | loss 0.0001391361147398129
* Acc@1 100.0 | loss 0.00022338592680171132
* Acc@1 100.0 | loss 0.0011809380957856774
* Acc@1 100.0 | loss 0.00039187996299006045
* Acc@1 100.0 | loss 0.0003080163733102381
* Acc@1 100.0 | loss 0.0011760147754102945
* Acc@1 100.0 | loss 0.00019093927403446287
* Acc@1 100.0 | loss 0.006849006749689579
* Acc@1 94.53125 | loss 0.18831506371498108
* Acc@1 95.3125 | loss 0.15011072158813477
* Acc@1 84.375 | loss 0.36362746357917786
* Acc@1 73.4375 | loss 0.755215585231781
* Acc@1 96.09375 | loss 0.16320186853408813
* Acc@1 85.9375 | loss 0.39295122027397156
* Acc@1 83.59375 | loss 0.3716195523738861
* Acc@1 82.03125 | loss 0.42469531297683716
* Acc@1 92.96875 | loss 0.16756020486354828
* Acc@1 88.28125 | loss 0.28866124153137207
* Acc@1 80.46875 | loss 0.447741836309433
* Acc@1 61.71875 | loss 1.2292068004608154
* Acc@1 79.6875 | loss 0.4853249192237854
* Acc@1 86.71875 | loss 0.3458578884601593
* Acc@1 71.875 | loss 0.7847434878349304
* Acc@1 82.03125 | loss 0.4333190619945526
* Acc@1 89.0625 | loss 0.2580501437187195
* Acc@1 83.59375 | loss 0.3518025279045105
* Acc@1 81.25 | loss 0.37223711609840393
* Acc@1 100.0 | loss 0.014812386594712734
* Acc@1 99.21875 | loss 0.060106147080659866
* Acc@1 100.0 | loss 0.023435842245817184
* Acc@1 100.0 | loss 0.02144685760140419
* Acc@1 94.53125 | loss 0.13492780923843384
* Acc@1 95.3125 | loss 0.14151272177696228
* Acc@1 98.4375 | loss 0.04734421521425247
* Acc@1 95.3125 | loss 0.08699291944503784
* Acc@1 97.65625 | loss 0.07445327192544937
* Acc@1 82.03125 | loss 0.41513797640800476
* Acc@1 100.0 | loss 0.020484725013375282
* Acc@1 100.0 | loss 0.017313828691840172
* Acc@1 99.21875 | loss 0.059404511004686356
* Acc@1 99.21875 | loss 0.02680109068751335
* Acc@1 96.875 | loss 0.06776164472103119
* Acc@1 100.0 | loss 0.00042712557478807867
* Acc@1 31.25 | loss 2.213074207305908
* Acc@1 99.21875 | loss 0.03336450085043907
* Acc@1 100.0 | loss 0.0006538214511238039
* Acc@1 100.0 | loss 0.0018460481660440564
* Acc@1 99.21875 | loss 0.03682193532586098
* Acc@1 95.3125 | loss 0.0812474712729454
* Acc@1 92.96875 | loss 0.19317388534545898
* Acc@1 76.5625 | loss 0.509556233882904
* Acc@1 96.875 | loss 0.09514136612415314
* Acc@1 100.0 | loss 0.005840866826474667
* Acc@1 100.0 | loss 0.015901971608400345
* Acc@1 100.0 | loss 0.0016287490725517273
* Acc@1 100.0 | loss 0.0002339584898436442
* Acc@1 100.0 | loss 5.557261101785116e-05
* Acc@1 95.3125 | loss 0.08432397991418839
* Acc@1 100.0 | loss 0.002459722338244319
* Acc@1 100.0 | loss 1.179378159577027e-05
* Acc@1 100.0 | loss 0.0019113416783511639
* Acc@1 82.03125 | loss 0.5169709324836731
* Acc@1 74.21875 | loss 0.654136598110199
* Acc@1 100.0 | loss 0.006275806576013565
* Acc@1 100.0 | loss 0.00014078181993681937
* Acc@1 100.0 | loss 0.00389335909858346
* Acc@1 100.0 | loss 0.001391647383570671
* Acc@1 100.0 | loss 0.0007927033584564924
* Acc@1 89.84375 | loss 0.17996497452259064
* Acc@1 100.0 | loss 0.010020554065704346
* Acc@1 99.21875 | loss 0.016339031979441643
* Acc@1 100.0 | loss 0.001646211021579802
* Acc@1 98.4375 | loss 0.028967123478651047
* Acc@1 100.0 | loss 0.0070586055517196655
* Acc@1 93.75 | loss 0.1717507690191269
* Acc@1 93.75 | loss 0.1941647082567215
* Acc@1 100.0 | loss 0.0015684131067246199
* Acc@1 96.875 | loss 0.10036735236644745
* Acc@1 92.96875 | loss 0.20347414910793304
* Acc@1 96.875 | loss 0.042700182646512985
* Acc@1 96.875 | loss 0.09181885421276093
* Acc@1 82.8125 | loss 0.3746161460876465
* Acc@1 100.0 | loss 0.004453353118151426
* Acc@1 97.65625 | loss 0.05331949144601822
* Acc@1 99.14530181884766 | loss 0.038888875395059586
========== Done Evaluating Model on Test partition ==========

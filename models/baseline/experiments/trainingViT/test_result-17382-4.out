running job: 4
| distributed init (rank 0): env://
fatal: not a git repository (or any parent up to mount point /)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
git:
  sha: N/A, status: clean, branch: N/A

arch: vit_small
avgpool_patchtokens: False
batch_size_per_gpu: 128
checkpoint_key: teacher
data_path: /home-mscluster/erex/research_project/datasets/Covidx-CT
dist_url: env://
epochs: 100
evaluate: False
evaluate_on_test: True
gpu: 0
local_rank: 0
lr: 0.001
n_last_blocks: 4
num_labels: 2
num_workers: 10
output_dir: /home-mscluster/erex/research_project/models/baseline/experiments/trainingViT/saving_dir4
patch_size: 16
pretrained_linear_weights: /home-mscluster/erex/research_project/models/baseline/experiments/trainingViT/saving_dir4/checkpoint.pth.tar
pretrained_weights: /home-mscluster/erex/research_project/models/baseline/experiments/pre-trainingViT/saving_dir1/checkpoint.pth
rank: 0
val_freq: 1
world_size: 1
Take key teacher in provided checkpoint dict
Pretrained weights found at /home-mscluster/erex/research_project/models/baseline/experiments/pre-trainingViT/saving_dir1/checkpoint.pth and loaded with msg: _IncompatibleKeys(missing_keys=[], unexpected_keys=['head.mlp.0.weight', 'head.mlp.0.bias', 'head.mlp.2.weight', 'head.mlp.2.bias', 'head.mlp.4.weight', 'head.mlp.4.bias', 'head.last_layer.weight_g', 'head.last_layer.weight_v'])
Model vit_small built.
/home-mscluster/erex/anaconda3/lib/python3.9/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
============ Evaluating Model on Test partition ============
* Acc@1 7.8125 | loss 3.3426637649536133
* Acc@1 3.125 | loss 2.9025087356567383
* Acc@1 0.0 | loss 4.460792064666748
* Acc@1 27.34375 | loss 3.3788771629333496
* Acc@1 16.40625 | loss 3.7209267616271973
* Acc@1 21.09375 | loss 1.9295814037322998
* Acc@1 17.1875 | loss 1.4980093240737915
* Acc@1 41.40625 | loss 1.0254864692687988
* Acc@1 34.375 | loss 1.3500880002975464
* Acc@1 39.84375 | loss 1.2412611246109009
* Acc@1 28.90625 | loss 1.7548081874847412
* Acc@1 28.90625 | loss 2.137925148010254
* Acc@1 32.03125 | loss 1.740020990371704
* Acc@1 23.4375 | loss 1.6706292629241943
* Acc@1 19.53125 | loss 1.642102837562561
* Acc@1 37.5 | loss 1.3196191787719727
* Acc@1 36.71875 | loss 1.4973610639572144
* Acc@1 37.5 | loss 1.0212011337280273
* Acc@1 21.875 | loss 1.4152164459228516
* Acc@1 55.46875 | loss 0.872221052646637
* Acc@1 42.96875 | loss 0.9563506245613098
* Acc@1 45.3125 | loss 0.9295579791069031
* Acc@1 28.90625 | loss 1.3637914657592773
* Acc@1 29.6875 | loss 1.4863483905792236
* Acc@1 18.75 | loss 2.123687505722046
* Acc@1 88.28125 | loss 0.3061978816986084
* Acc@1 78.90625 | loss 0.47312235832214355
* Acc@1 50.0 | loss 0.7758772373199463
* Acc@1 62.5 | loss 0.6245989799499512
* Acc@1 30.46875 | loss 1.618155837059021
* Acc@1 10.9375 | loss 2.632331132888794
* Acc@1 17.1875 | loss 2.234837293624878
* Acc@1 23.4375 | loss 1.6089493036270142
* Acc@1 23.4375 | loss 2.09307861328125
* Acc@1 50.78125 | loss 0.910431981086731
* Acc@1 21.09375 | loss 1.6299617290496826
* Acc@1 24.21875 | loss 1.3290568590164185
* Acc@1 46.875 | loss 0.9861801862716675
* Acc@1 39.84375 | loss 1.1220849752426147
* Acc@1 27.34375 | loss 1.5139719247817993
* Acc@1 41.40625 | loss 1.2867517471313477
* Acc@1 29.6875 | loss 1.208376169204712
* Acc@1 49.21875 | loss 1.0036771297454834
* Acc@1 19.53125 | loss 1.7848594188690186
* Acc@1 14.84375 | loss 1.8742198944091797
* Acc@1 23.4375 | loss 2.1498477458953857
* Acc@1 22.65625 | loss 1.6431961059570312
* Acc@1 12.5 | loss 1.8251574039459229
* Acc@1 35.9375 | loss 1.4283628463745117
* Acc@1 99.21875 | loss 0.010856878012418747
* Acc@1 100.0 | loss 0.0036759290378540754
* Acc@1 100.0 | loss 0.002527676522731781
* Acc@1 100.0 | loss 0.01829390972852707
* Acc@1 100.0 | loss 0.0004419574688654393
* Acc@1 100.0 | loss 0.0005818376084789634
* Acc@1 100.0 | loss 0.008602108806371689
* Acc@1 97.65625 | loss 0.060437075793743134
* Acc@1 100.0 | loss 0.036964233964681625
* Acc@1 100.0 | loss 0.019054772332310677
* Acc@1 100.0 | loss 0.0032973873894661665
* Acc@1 98.4375 | loss 0.05973877012729645
* Acc@1 100.0 | loss 0.03407565504312515
* Acc@1 89.84375 | loss 0.16409380733966827
* Acc@1 85.9375 | loss 0.2409786731004715
* Acc@1 93.75 | loss 0.11060155183076859
* Acc@1 94.53125 | loss 0.18471816182136536
* Acc@1 100.0 | loss 0.025616511702537537
* Acc@1 100.0 | loss 0.0014121151762083173
* Acc@1 100.0 | loss 0.016504859551787376
* Acc@1 96.875 | loss 0.12919017672538757
* Acc@1 100.0 | loss 0.02899540774524212
* Acc@1 100.0 | loss 0.0007049896521493793
* Acc@1 98.4375 | loss 0.0437408983707428
* Acc@1 100.0 | loss 0.0053606522269546986
* Acc@1 100.0 | loss 0.001496333396062255
* Acc@1 97.65625 | loss 0.06804970651865005
* Acc@1 93.75 | loss 0.16467387974262238
* Acc@1 92.1875 | loss 0.2656286954879761
* Acc@1 67.96875 | loss 0.5786783695220947
* Acc@1 83.59375 | loss 0.31965163350105286
* Acc@1 99.21875 | loss 0.05818064510822296
* Acc@1 100.0 | loss 0.003533298149704933
* Acc@1 99.21875 | loss 0.0329006090760231
* Acc@1 100.0 | loss 0.015767008066177368
* Acc@1 91.40625 | loss 0.1811063438653946
* Acc@1 96.875 | loss 0.08424818515777588
* Acc@1 96.09375 | loss 0.09286216646432877
* Acc@1 94.53125 | loss 0.12083625048398972
* Acc@1 91.40625 | loss 0.20680823922157288
* Acc@1 83.59375 | loss 0.36858949065208435
* Acc@1 93.75 | loss 0.13041622936725616
* Acc@1 45.3125 | loss 1.2117801904678345
* Acc@1 100.0 | loss 0.0058108787052333355
* Acc@1 100.0 | loss 0.006912330165505409
* Acc@1 100.0 | loss 0.00253864424303174
* Acc@1 100.0 | loss 0.010399199090898037
* Acc@1 98.4375 | loss 0.06380829960107803
* Acc@1 99.21875 | loss 0.06568099558353424
* Acc@1 100.0 | loss 0.0038409880362451077
* Acc@1 100.0 | loss 0.005859982687979937
* Acc@1 100.0 | loss 0.020267706364393234
* Acc@1 91.40625 | loss 0.22887647151947021
* Acc@1 98.4375 | loss 0.05887926369905472
* Acc@1 79.6875 | loss 0.3432283103466034
* Acc@1 100.0 | loss 0.0009275262127630413
* Acc@1 100.0 | loss 0.00699884258210659
* Acc@1 74.21875 | loss 0.7857849597930908
* Acc@1 65.625 | loss 0.7994050979614258
* Acc@1 39.84375 | loss 1.4851949214935303
* Acc@1 51.5625 | loss 1.4683010578155518
* Acc@1 26.5625 | loss 1.2699775695800781
* Acc@1 64.84375 | loss 0.6601784825325012
* Acc@1 75.78125 | loss 0.4865075647830963
* Acc@1 91.40625 | loss 0.11413674801588058
* Acc@1 100.0 | loss 0.005447803996503353
* Acc@1 100.0 | loss 0.0017204631585627794
* Acc@1 100.0 | loss 0.009119519032537937
* Acc@1 100.0 | loss 0.01762441359460354
* Acc@1 100.0 | loss 0.014000333845615387
* Acc@1 100.0 | loss 0.0005850674933753908
* Acc@1 100.0 | loss 0.0007476959726773202
* Acc@1 100.0 | loss 0.0013264616718515754
* Acc@1 100.0 | loss 0.0004928059643134475
* Acc@1 100.0 | loss 0.00233246898278594
* Acc@1 100.0 | loss 0.0040197125636041164
* Acc@1 100.0 | loss 0.008807778358459473
* Acc@1 100.0 | loss 0.011415026150643826
* Acc@1 100.0 | loss 0.0008694131392985582
* Acc@1 100.0 | loss 0.00494318688288331
* Acc@1 100.0 | loss 0.004148294683545828
* Acc@1 95.3125 | loss 0.13782517611980438
* Acc@1 100.0 | loss 0.01834171451628208
* Acc@1 100.0 | loss 0.006441815290600061
* Acc@1 100.0 | loss 0.0052075376734137535
* Acc@1 100.0 | loss 0.004445159342139959
* Acc@1 100.0 | loss 0.00805684644728899
* Acc@1 99.21875 | loss 0.020579595118761063
* Acc@1 100.0 | loss 0.013577129691839218
* Acc@1 100.0 | loss 0.003239803249016404
* Acc@1 100.0 | loss 0.008726092055439949
* Acc@1 100.0 | loss 0.0030114371329545975
* Acc@1 100.0 | loss 0.0031215993221849203
* Acc@1 100.0 | loss 0.003357321722432971
* Acc@1 100.0 | loss 0.004343164619058371
* Acc@1 100.0 | loss 0.009085871279239655
* Acc@1 100.0 | loss 0.003123795846477151
* Acc@1 100.0 | loss 0.0017045208951458335
* Acc@1 100.0 | loss 0.0022396815475076437
* Acc@1 100.0 | loss 0.006667697336524725
* Acc@1 100.0 | loss 0.003604667726904154
* Acc@1 100.0 | loss 0.009408785030245781
* Acc@1 100.0 | loss 0.006462796591222286
* Acc@1 100.0 | loss 0.005110184196382761
* Acc@1 100.0 | loss 0.0013151776511222124
* Acc@1 100.0 | loss 0.017042316496372223
* Acc@1 100.0 | loss 0.008613514713943005
* Acc@1 99.21875 | loss 0.032073359936475754
* Acc@1 91.40625 | loss 0.22120748460292816
* Acc@1 98.4375 | loss 0.06687503308057785
* Acc@1 99.21875 | loss 0.066871277987957
* Acc@1 100.0 | loss 0.003167208516970277
* Acc@1 100.0 | loss 0.006634821183979511
* Acc@1 100.0 | loss 0.004030679352581501
* Acc@1 100.0 | loss 0.0045790537260472775
* Acc@1 98.4375 | loss 0.046863142400979996
* Acc@1 100.0 | loss 0.005667402874678373
* Acc@1 100.0 | loss 0.0014507060404866934
* Acc@1 100.0 | loss 0.0005425878916867077
* Acc@1 100.0 | loss 0.00024098576977849007
* Acc@1 100.0 | loss 0.0001259247219422832
* Acc@1 100.0 | loss 0.0012229938292875886
* Acc@1 100.0 | loss 0.001586197060532868
* Acc@1 100.0 | loss 4.9751259211916476e-05
* Acc@1 100.0 | loss 6.918869621586055e-05
* Acc@1 100.0 | loss 0.00048377964412793517
* Acc@1 100.0 | loss 5.267044616630301e-05
* Acc@1 100.0 | loss 7.458827167283744e-05
* Acc@1 100.0 | loss 3.892578024533577e-05
* Acc@1 100.0 | loss 0.0003623068332672119
* Acc@1 100.0 | loss 0.00011581453145481646
* Acc@1 100.0 | loss 0.0002446331491228193
* Acc@1 100.0 | loss 0.0007214653305709362
* Acc@1 100.0 | loss 0.0003109724202658981
* Acc@1 100.0 | loss 0.0001764685002854094
* Acc@1 100.0 | loss 0.0006246998673304915
* Acc@1 100.0 | loss 0.00014738482423126698
* Acc@1 99.21875 | loss 0.014438895508646965
* Acc@1 93.75 | loss 0.160653755068779
* Acc@1 97.65625 | loss 0.11014639586210251
* Acc@1 89.0625 | loss 0.24406813085079193
* Acc@1 72.65625 | loss 0.737972617149353
* Acc@1 98.4375 | loss 0.1113147959113121
* Acc@1 91.40625 | loss 0.31373095512390137
* Acc@1 89.0625 | loss 0.25366297364234924
* Acc@1 82.03125 | loss 0.3594384789466858
* Acc@1 92.96875 | loss 0.16479256749153137
* Acc@1 91.40625 | loss 0.21446672081947327
* Acc@1 84.375 | loss 0.3414936363697052
* Acc@1 66.40625 | loss 1.0516287088394165
* Acc@1 86.71875 | loss 0.2969072163105011
* Acc@1 87.5 | loss 0.27855974435806274
* Acc@1 73.4375 | loss 0.7249341607093811
* Acc@1 79.6875 | loss 0.4654187262058258
* Acc@1 84.375 | loss 0.28202617168426514
* Acc@1 89.0625 | loss 0.22370930016040802
* Acc@1 80.46875 | loss 0.4328470826148987
* Acc@1 100.0 | loss 0.019524667412042618
* Acc@1 98.4375 | loss 0.10577979683876038
* Acc@1 100.0 | loss 0.03304208815097809
* Acc@1 100.0 | loss 0.022694338113069534
* Acc@1 94.53125 | loss 0.09158170968294144
* Acc@1 92.96875 | loss 0.15621259808540344
* Acc@1 96.875 | loss 0.07483401149511337
* Acc@1 95.3125 | loss 0.07320276647806168
* Acc@1 98.4375 | loss 0.07072056829929352
* Acc@1 84.375 | loss 0.35530465841293335
* Acc@1 100.0 | loss 0.023703766986727715
* Acc@1 100.0 | loss 0.013835372403264046
* Acc@1 96.09375 | loss 0.12952816486358643
* Acc@1 100.0 | loss 0.02119511552155018
* Acc@1 94.53125 | loss 0.133265882730484
* Acc@1 100.0 | loss 0.00400293106213212
* Acc@1 32.03125 | loss 2.084808111190796
* Acc@1 97.65625 | loss 0.04603620246052742
* Acc@1 100.0 | loss 0.0016987028066068888
* Acc@1 100.0 | loss 0.00393504835665226
* Acc@1 99.21875 | loss 0.05657145008444786
* Acc@1 96.875 | loss 0.09107591211795807
* Acc@1 89.0625 | loss 0.27940142154693604
* Acc@1 74.21875 | loss 0.666495680809021
* Acc@1 96.875 | loss 0.09104624390602112
* Acc@1 100.0 | loss 0.009273449890315533
* Acc@1 99.21875 | loss 0.03103150613605976
* Acc@1 100.0 | loss 0.004023675341159105
* Acc@1 100.0 | loss 0.000841042201500386
* Acc@1 100.0 | loss 0.00014999700943008065
* Acc@1 91.40625 | loss 0.18422585725784302
* Acc@1 100.0 | loss 0.0037586279213428497
* Acc@1 100.0 | loss 8.760190394241363e-05
* Acc@1 100.0 | loss 0.005130625795572996
* Acc@1 76.5625 | loss 0.610231876373291
* Acc@1 62.5 | loss 0.8294669985771179
* Acc@1 100.0 | loss 0.017846545204520226
* Acc@1 100.0 | loss 0.0006123149651102722
* Acc@1 100.0 | loss 0.0030059325508773327
* Acc@1 99.21875 | loss 0.010263058356940746
* Acc@1 100.0 | loss 0.001071533071808517
* Acc@1 91.40625 | loss 0.13236495852470398
* Acc@1 100.0 | loss 0.014870460145175457
* Acc@1 99.21875 | loss 0.015547052025794983
* Acc@1 100.0 | loss 0.004149761516600847
* Acc@1 98.4375 | loss 0.04091355577111244
* Acc@1 100.0 | loss 0.00985238328576088
* Acc@1 88.28125 | loss 0.24569419026374817
* Acc@1 93.75 | loss 0.20749995112419128
* Acc@1 100.0 | loss 0.0016290656058117747
* Acc@1 96.875 | loss 0.09958851337432861
* Acc@1 93.75 | loss 0.1921730786561966
* Acc@1 97.65625 | loss 0.04494312033057213
* Acc@1 95.3125 | loss 0.12068905681371689
* Acc@1 78.90625 | loss 0.4890552759170532
* Acc@1 100.0 | loss 0.00606024032458663
* Acc@1 94.53125 | loss 0.0956609696149826
* Acc@1 100.00000762939453 | loss 0.0307671669870615
========== Done Evaluating Model on Test partition ==========
